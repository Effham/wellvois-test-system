import { useState, useMemo, useCallback, memo } from 'react';
import { Head, router } from '@inertiajs/react';
import AppLayout from '@/layouts/app-layout';
import PageHeader from '@/components/general/PageHeader';
import { Badge } from '@/components/ui/badge';
import { Button } from '@/components/ui/button';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from '@/components/ui/dialog';
import { Label } from '@/components/ui/label';
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';
import { Sheet, SheetContent, SheetDescription, SheetHeader, SheetTitle, SheetTrigger } from '@/components/ui/sheet';
import { CalendarIcon, ClockIcon, MapPinIcon, UserIcon, ChevronLeftIcon, ChevronRightIcon, PlusIcon, FilterIcon, BuildingIcon, SlidersHorizontalIcon, RotateCcw, X } from 'lucide-react';
import { BreadcrumbItem } from '@/types';

type Appointment = {
    id: number | string;
    title: string;
    date: string;
    time: string;
    duration: number;
    patient?: string;
    practitioner?: string;
    type: string;
    status: 'confirmed' | 'pending' | 'urgent' | 'cancelled' | 'completed';
    location: string;
    clinic?: string;
    notes?: string;
    source: 'clinic' | 'google';
    clickable: boolean;
    description?: string;
};

type CalendarPageProps = {
    appointments: Appointment[];
    currentDate: string;
    isCentral?: boolean;
    practitioner?: any;
};

const statusColors = {
    confirmed: 'bg-green-100 text-green-800 border-green-200',
    pending: 'bg-yellow-100 text-yellow-800 border-yellow-200',
    urgent: 'bg-red-100 text-red-800 border-red-200',
    cancelled: 'bg-gray-100 text-gray-800 border-gray-200',
    completed: 'bg-blue-100 text-blue-800 border-blue-200',
};

const typeColors = {
    'General Consultation': 'bg-blue-50 border-l-blue-400',
    'Follow-up': 'bg-purple-50 border-l-purple-400',
    'Initial Consultation': 'bg-green-50 border-l-green-400',
    'Routine Checkup': 'bg-gray-50 border-l-gray-400',
    'Emergency': 'bg-red-50 border-l-red-400',
    'Physical Therapy': 'bg-orange-50 border-l-orange-400',
    'Diabetes Management': 'bg-indigo-50 border-l-indigo-400',
    'Pediatric Care': 'bg-pink-50 border-l-pink-400',
    'Vaccination': 'bg-cyan-50 border-l-cyan-400',
    'Mental Health': 'bg-teal-50 border-l-teal-400',
    'Cardiology': 'bg-rose-50 border-l-rose-400',
    'Laboratory': 'bg-amber-50 border-l-amber-400',
    'Orthopedic': 'bg-lime-50 border-l-lime-400',
    'Dermatology': 'bg-emerald-50 border-l-emerald-400',
    'Prenatal Care': 'bg-violet-50 border-l-violet-400',
    'Surgery': 'bg-red-100 border-l-red-500',
    'Neurology': 'bg-purple-100 border-l-purple-500',
    'Critical Care': 'bg-gray-100 border-l-gray-500',
    'Oncology': 'bg-rose-100 border-l-rose-500',
    'Dialysis': 'bg-cyan-100 border-l-cyan-500',
    'Diagnostic': 'bg-amber-100 border-l-amber-500',
    'Pain Management': 'bg-orange-100 border-l-orange-500',
    'Sleep Study': 'bg-slate-100 border-l-slate-500',
    'Dental Care': 'bg-lime-100 border-l-lime-500',
    'Eye Exam': 'bg-sky-100 border-l-sky-500',
    'Ophthalmology': 'bg-sky-100 border-l-sky-500',
    'Wound Care': 'bg-stone-100 border-l-stone-500',
    'Consultation': 'bg-blue-100 border-l-blue-500',
};

function getDaysInMonth(date: Date): Date[] {
    const year = date.getFullYear();
    const month = date.getMonth();
    const firstDay = new Date(year, month, 1);
    const lastDay = new Date(year, month + 1, 0);
    const daysInMonth = lastDay.getDate();
    
    // Get first day of week (0 = Sunday)
    const startDay = firstDay.getDay();
    
    const days: Date[] = [];
    
    // Add empty days for previous month
    for (let i = 0; i < startDay; i++) {
        const prevDate = new Date(year, month, -startDay + i + 1);
        days.push(prevDate);
    }
    
    // Add days of current month
    for (let i = 1; i <= daysInMonth; i++) {
        days.push(new Date(year, month, i));
    }
    
    // Add days for next month to complete the grid (42 days = 6 rows)
    const remaining = 42 - days.length;
    for (let i = 1; i <= remaining; i++) {
        days.push(new Date(year, month + 1, i));
    }
    
    return days;
}

function formatTime(time: string): string {
    return new Date(`1970-01-01T${time}`).toLocaleTimeString('en-US', {
        hour: 'numeric',
        minute: '2-digit',
        hour12: true
    });
}

export default function CalendarIndex({ appointments, currentDate, isCentral = false, practitioner }: CalendarPageProps) {
    const breadcrumbs: BreadcrumbItem[] = isCentral 
        ? [
            { title: 'Dashboard', href: '/central/practitioner-dashboard' },
            { title: 'Calendar', href: '/central/calendar' },
          ]
        : [
            { title: 'Dashboard', href: '/dashboard' },
            { title: 'Calendar', href: '/calendar' },
          ];

    const [selectedDate, setSelectedDate] = useState(new Date(currentDate));
    // Applied filters (what's actually filtering the data)
    const [appliedClinic, setAppliedClinic] = useState<string>('all');
    const [appliedStatus, setAppliedStatus] = useState<string>('all');
    // Pending filters (what's selected in the UI but not yet applied)
    const [pendingClinic, setPendingClinic] = useState<string>('all');
    const [pendingStatus, setPendingStatus] = useState<string>('all');
    const [isFilterOpen, setIsFilterOpen] = useState(false);
    const [dayViewOpen, setDayViewOpen] = useState(false);
    const [selectedDayAppointments, setSelectedDayAppointments] = useState<Appointment[]>([]);
    const [currentView, setCurrentView] = useState<'month' | 'week' | 'day' | 'list'>('month');
    const [selectedDetailDate, setSelectedDetailDate] = useState<Date | null>(null);

    // Source filtering state
    const [showOnlySystemAppointments, setShowOnlySystemAppointments] = useState(false);

    // Filter appointments by source
    const sourceFilteredAppointments = useMemo(() => {
        if (showOnlySystemAppointments) {
            return appointments.filter(apt => apt.source === 'clinic');
        }
        return appointments;
    }, [appointments, showOnlySystemAppointments]);

    // Clinic color mapping for visual identification
    const clinicColors = {
        'SSO Clinic': { bg: 'bg-blue-50', border: 'border-l-blue-500', text: 'text-blue-700', dot: 'bg-blue-500' },
        'McDowall Health': { bg: 'bg-green-50', border: 'border-l-green-500', text: 'text-green-700', dot: 'bg-green-500' },
        'Downtown Medical Center': { bg: 'bg-purple-50', border: 'border-l-purple-500', text: 'text-purple-700', dot: 'bg-purple-500' },
        'Northside Family Clinic': { bg: 'bg-orange-50', border: 'border-l-orange-500', text: 'text-orange-700', dot: 'bg-orange-500' },
        'West End Health Center': { bg: 'bg-pink-50', border: 'border-l-pink-500', text: 'text-pink-700', dot: 'bg-pink-500' },
        'Suburban Care Clinic': { bg: 'bg-indigo-50', border: 'border-l-indigo-500', text: 'text-indigo-700', dot: 'bg-indigo-500' },
        'Central Hospital': { bg: 'bg-teal-50', border: 'border-l-teal-500', text: 'text-teal-700', dot: 'bg-teal-500' },
        'Family Care Center': { bg: 'bg-red-50', border: 'border-l-red-500', text: 'text-red-700', dot: 'bg-red-500' },
    };

    // Source color mapping for visual identification
    const sourceColors = {
        'clinic': { bg: 'bg-blue-50', border: 'border-l-blue-500', text: 'text-blue-700', icon: 'üè•' },
        'google': { bg: 'bg-green-50', border: 'border-l-green-500', text: 'text-green-700', icon: 'üìÖ' },
    };
            title: 'Follow-up Visit - Jane Doe',
            date: '2025-01-15',
            time: '14:30',
            duration: 30,
            patient: 'Jane Doe',
            practitioner: 'Dr. Michael Chen',
            type: 'Follow-up',
            status: 'confirmed',
            location: 'Room 102',
            clinic: 'SSO Clinic',
            notes: 'Follow-up on blood pressure medication'
        },
        {
            id: 3,
            title: 'Consultation - Mike Johnson',
            date: '2025-01-16',
            time: '10:15',
            duration: 45,
            patient: 'Mike Johnson',
            practitioner: 'Dr. Sarah Johnson',
            type: 'Initial Consultation',
            status: 'pending',
            location: 'Room 101',
            clinic: 'SSO Clinic',
            notes: 'New patient consultation'
        },
        // McDowall Health Appointments
        {
            id: 4,
            title: 'Diabetes Check - Mary Wilson',
            date: '2025-01-15',
            time: '08:30',
            duration: 45,
            patient: 'Mary Wilson',
            practitioner: 'Dr. Jennifer Adams',
            type: 'Diabetes Management',
            status: 'confirmed',
            location: 'Room 201',
            clinic: 'McDowall Health',
            notes: 'Quarterly diabetes monitoring'
        },
        {
            id: 5,
            title: 'Therapy Session - Robert Brown',
            date: '2025-01-16',
            time: '13:00',
            duration: 60,
            patient: 'Robert Brown',
            practitioner: 'Dr. Lisa Thompson',
            type: 'Physical Therapy',
            status: 'confirmed',
            location: 'Therapy Room A',
            clinic: 'McDowall Health',
            notes: 'Post-surgery rehabilitation'
        },
        {
            id: 6,
            title: 'Emergency Consultation - David Lee',
            date: '2025-01-17',
            time: '16:00',
            duration: 30,
            patient: 'David Lee',
            practitioner: 'Dr. Jennifer Adams',
            type: 'Emergency',
            status: 'urgent',
            location: 'Room 203',
            clinic: 'McDowall Health',
            notes: 'Urgent care - chest pain'
        },
        // Mahroz Clinic Appointments
        {
            id: 7,
            title: 'Pediatric Checkup - Emma Garcia',
            date: '2025-01-18',
            time: '10:00',
            duration: 30,
            patient: 'Emma Garcia',
            practitioner: 'Dr. Ahmed Mahroz',
            type: 'Pediatric Care',
            status: 'confirmed',
            location: 'Pediatric Room',
            clinic: 'Mahroz Clinic',
            notes: 'Routine 6-month checkup'
        },
        {
            id: 8,
            title: 'Vaccination - Tommy Martinez',
            date: '2025-01-18',
            time: '11:30',
            duration: 15,
            patient: 'Tommy Martinez',
            practitioner: 'Nurse Patricia Rodriguez',
            type: 'Vaccination',
            status: 'confirmed',
            location: 'Vaccination Station',
            clinic: 'Mahroz Clinic',
            notes: 'MMR booster shot'
        },
        {
            id: 9,
            title: 'Mental Health Session - Alex Taylor',
            date: '2025-01-19',
            time: '14:00',
            duration: 50,
            patient: 'Alex Taylor',
            practitioner: 'Dr. Fatima Al-Zahra',
            type: 'Mental Health',
            status: 'confirmed',
            location: 'Counseling Room',
            clinic: 'Mahroz Clinic',
            notes: 'Weekly therapy session'
        },
        // Imran Medical Center Appointments
        {
            id: 10,
            title: 'Cardiology Consultation - Richard Clark',
            date: '2025-01-20',
            time: '09:30',
            duration: 60,
            patient: 'Richard Clark',
            practitioner: 'Dr. Imran Hassan',
            type: 'Cardiology',
            status: 'confirmed',
            location: 'Cardiology Suite',
            clinic: 'Imran Medical Center',
            notes: 'Heart rhythm evaluation'
        },
        {
            id: 11,
            title: 'Routine Blood Work - Susan Davis',
            date: '2025-01-21',
            time: '07:30',
            duration: 20,
            patient: 'Susan Davis',
            practitioner: 'Lab Technician Maria Santos',
            type: 'Laboratory',
            status: 'confirmed',
            location: 'Lab Room 1',
            clinic: 'Imran Medical Center',
            notes: 'Fasting blood panel'
        },
        {
            id: 12,
            title: 'Dermatology Screening - Rachel Green',
            date: '2025-01-23',
            time: '11:00',
            duration: 40,
            patient: 'Rachel Green',
            practitioner: 'Dr. Muneeb Dermatologist',
            type: 'Dermatology',
            status: 'pending',
            location: 'Dermatology Room',
            clinic: 'Muneeb Clinic',
            notes: 'Annual skin cancer screening'
        },

        // August 2025 Appointments
        // SSO Clinic August
        {
            id: 13,
            title: 'Heart Surgery Consultation - William Anderson',
            date: '2025-08-01',
            time: '09:00',
            duration: 90,
            patient: 'William Anderson',
            practitioner: 'Dr. Sarah Johnson',
            type: 'Cardiology',
            status: 'confirmed',
            location: 'Consultation Room A',
            clinic: 'SSO Clinic',
            notes: 'Pre-operative consultation for cardiac surgery'
        },
        {
            id: 14,
            title: 'Physical Therapy - Maria Lopez',
            date: '2025-08-02',
            time: '14:00',
            duration: 60,
            patient: 'Maria Lopez',
            practitioner: 'Dr. Michael Chen',
            type: 'Physical Therapy',
            status: 'confirmed',
            location: 'Therapy Room 1',
            clinic: 'SSO Clinic',
            notes: 'Recovery session post knee surgery'
        },
        {
            id: 15,
            title: 'Routine Checkup - James Wilson',
            date: '2025-08-05',
            time: '10:30',
            duration: 45,
            patient: 'James Wilson',
            practitioner: 'Dr. Sarah Johnson',
            type: 'General Consultation',
            status: 'pending',
            location: 'Room 101',
            clinic: 'SSO Clinic',
            notes: 'Annual health screening'
        },

        // McDowall Health August
        {
            id: 16,
            title: 'Diabetes Management - Carol Thompson',
            date: '2025-08-03',
            time: '08:00',
            duration: 30,
            patient: 'Carol Thompson',
            practitioner: 'Dr. Jennifer Adams',
            type: 'Diabetes Management',
            status: 'confirmed',
            location: 'Room 201',
            clinic: 'McDowall Health',
            notes: 'Monthly blood sugar monitoring'
        },
        {
            id: 17,
            title: 'Emergency Visit - Robert Davis',
            date: '2025-08-04',
            time: '16:45',
            duration: 20,
            patient: 'Robert Davis',
            practitioner: 'Dr. Lisa Thompson',
            type: 'Emergency',
            status: 'urgent',
            location: 'Emergency Room',
            clinic: 'McDowall Health',
            notes: 'Severe headache and dizziness'
        },
        {
            id: 18,
            title: 'Physical Therapy - Nancy Garcia',
            date: '2025-08-06',
            time: '11:15',
            duration: 75,
            patient: 'Nancy Garcia',
            practitioner: 'Dr. Lisa Thompson',
            type: 'Physical Therapy',
            status: 'confirmed',
            location: 'Therapy Room B',
            clinic: 'McDowall Health',
            notes: 'Shoulder rehabilitation program'
        },

        // Mahroz Clinic August
        {
            id: 19,
            title: 'Pediatric Vaccination - Sophia Brown',
            date: '2025-08-07',
            time: '09:30',
            duration: 15,
            patient: 'Sophia Brown',
            practitioner: 'Dr. Ahmed Mahroz',
            type: 'Vaccination',
            status: 'confirmed',
            location: 'Pediatric Wing',
            clinic: 'Mahroz Clinic',
            notes: 'School immunization requirements'
        },
        {
            id: 20,
            title: 'Mental Health Session - Daniel Martinez',
            date: '2025-08-08',
            time: '13:00',
            duration: 50,
            patient: 'Daniel Martinez',
            practitioner: 'Dr. Fatima Al-Zahra',
            type: 'Mental Health',
            status: 'confirmed',
            location: 'Counseling Room',
            clinic: 'Mahroz Clinic',
            notes: 'Anxiety therapy session'
        },
        {
            id: 21,
            title: 'Newborn Checkup - Baby Johnson',
            date: '2025-08-09',
            time: '15:30',
            duration: 30,
            patient: 'Baby Johnson',
            practitioner: 'Dr. Ahmed Mahroz',
            type: 'Pediatric Care',
            status: 'confirmed',
            location: 'Newborn Unit',
            clinic: 'Mahroz Clinic',
            notes: '2-week wellness check'
        },

        // Imran Medical Center August
        {
            id: 22,
            title: 'Cardiac Stress Test - Michael Clark',
            date: '2025-08-10',
            time: '07:30',
            duration: 120,
            patient: 'Michael Clark',
            practitioner: 'Dr. Imran Hassan',
            type: 'Cardiology',
            status: 'confirmed',
            location: 'Cardiac Testing Lab',
            clinic: 'Imran Medical Center',
            notes: 'Exercise stress test with EKG monitoring'
        },
        {
            id: 23,
            title: 'Blood Work Follow-up - Linda White',
            date: '2025-08-12',
            time: '06:45',
            duration: 25,
            patient: 'Linda White',
            practitioner: 'Lab Technician Maria Santos',
            type: 'Laboratory',
            status: 'confirmed',
            location: 'Lab Room 2',
            clinic: 'Imran Medical Center',
            notes: 'Cholesterol and blood sugar follow-up'
        },
        {
            id: 24,
            title: 'Orthopedic Consultation - Kevin Wright',
            date: '2025-08-14',
            time: '12:00',
            duration: 60,
            patient: 'Kevin Wright',
            practitioner: 'Dr. Sarah Orthopedic',
            type: 'Orthopedic',
            status: 'pending',
            location: 'Orthopedic Suite',
            clinic: 'Imran Medical Center',
            notes: 'Post-surgery evaluation for knee replacement'
        },

        // Muneeb Clinic August
        {
            id: 25,
            title: 'Skin Cancer Screening - Patricia Green',
            date: '2025-08-15',
            time: '10:00',
            duration: 45,
            patient: 'Patricia Green',
            practitioner: 'Dr. Muneeb Dermatologist',
            type: 'Dermatology',
            status: 'confirmed',
            location: 'Dermatology Suite',
            clinic: 'Muneeb Clinic',
            notes: 'Annual full-body skin examination'
        },
        {
            id: 26,
            title: 'Prenatal Visit - Jennifer Miller',
            date: '2025-08-16',
            time: '14:30',
            duration: 40,
            patient: 'Jennifer Miller',
            practitioner: 'Dr. Muneeb OBGYN',
            type: 'Prenatal Care',
            status: 'confirmed',
            location: 'OBGYN Suite',
            clinic: 'Muneeb Clinic',
            notes: '32-week prenatal checkup with ultrasound'
        },
        {
            id: 27,
            title: 'Dermatology Follow-up - Mark Taylor',
            date: '2025-08-18',
            time: '11:45',
            duration: 30,
            patient: 'Mark Taylor',
            practitioner: 'Dr. Muneeb Dermatologist',
            type: 'Dermatology',
            status: 'pending',
            location: 'Dermatology Room',
            clinic: 'Muneeb Clinic',
            notes: 'Eczema treatment follow-up'
        },

        // Additional appointments to test crowded days - Multiple appointments per day
        // January 15, 2025 - Very crowded day (10 appointments)
        {
            id: 28,
            title: 'Emergency Visit - Sarah Williams',
            date: '2025-01-15',
            time: '07:00',
            duration: 30,
            patient: 'Sarah Williams',
            practitioner: 'Dr. Emergency Staff',
            type: 'Emergency',
            status: 'urgent',
            location: 'Emergency Room',
            clinic: 'SSO Clinic',
            notes: 'Chest pain evaluation'
        },
        {
            id: 29,
            title: 'Lab Work - Tom Jackson',
            date: '2025-01-15',
            time: '07:30',
            duration: 15,
            patient: 'Tom Jackson',
            practitioner: 'Lab Tech Alex',
            type: 'Laboratory',
            status: 'confirmed',
            location: 'Lab Room 2',
            clinic: 'McDowall Health',
            notes: 'Blood work for cholesterol'
        },
        {
            id: 30,
            title: 'Pediatric Checkup - Lucy Chen',
            date: '2025-01-15',
            time: '10:00',
            duration: 30,
            patient: 'Lucy Chen',
            practitioner: 'Dr. Pediatric Specialist',
            type: 'Pediatric Care',
            status: 'confirmed',
            location: 'Pediatric Room',
            clinic: 'Mahroz Clinic',
            notes: '3-year checkup'
        },
        {
            id: 31,
            title: 'Therapy Session - Mark Davis',
            date: '2025-01-15',
            time: '11:00',
            duration: 45,
            patient: 'Mark Davis',
            practitioner: 'Dr. Therapist One',
            type: 'Physical Therapy',
            status: 'confirmed',
            location: 'Therapy Room C',
            clinic: 'Imran Medical Center',
            notes: 'Post-accident rehabilitation'
        },
        {
            id: 32,
            title: 'Vaccination - Baby Rodriguez',
            date: '2025-01-15',
            time: '12:00',
            duration: 15,
            patient: 'Baby Rodriguez',
            practitioner: 'Nurse Johnson',
            type: 'Vaccination',
            status: 'confirmed',
            location: 'Vaccination Room',
            clinic: 'Muneeb Clinic',
            notes: '6-month vaccinations'
        },
        {
            id: 33,
            title: 'Cardiology Check - Robert Kim',
            date: '2025-01-15',
            time: '13:00',
            duration: 60,
            patient: 'Robert Kim',
            practitioner: 'Dr. Heart Specialist',
            type: 'Cardiology',
            status: 'pending',
            location: 'Cardiology Wing',
            clinic: 'SSO Clinic',
            notes: 'Heart palpitation investigation'
        },
        {
            id: 34,
            title: 'Dental Cleaning - Lisa Park',
            date: '2025-01-15',
            time: '15:00',
            duration: 45,
            patient: 'Lisa Park',
            practitioner: 'Dr. Dental Hygienist',
            type: 'Dental Care',
            status: 'confirmed',
            location: 'Dental Suite',
            clinic: 'McDowall Health',
            notes: 'Routine dental cleaning'
        },
        {
            id: 35,
            title: 'Mental Health - Kevin Smith',
            date: '2025-01-15',
            time: '16:00',
            duration: 50,
            patient: 'Kevin Smith',
            practitioner: 'Dr. Therapist Two',
            type: 'Mental Health',
            status: 'confirmed',
            location: 'Counseling Room B',
            clinic: 'Mahroz Clinic',
            notes: 'Anxiety management session'
        },
        {
            id: 36,
            title: 'Orthopedic Follow-up - Nancy Lee',
            date: '2025-01-15',
            time: '17:00',
            duration: 30,
            patient: 'Nancy Lee',
            practitioner: 'Dr. Bone Specialist',
            type: 'Orthopedic',
            status: 'confirmed',
            location: 'Orthopedic Room',
            clinic: 'Imran Medical Center',
            notes: 'Post-surgery check'
        },
        
        // January 16, 2025 - Moderately busy day (6 appointments)
        {
            id: 37,
            title: 'Morning Lab Work - Peter Wilson',
            date: '2025-01-16',
            time: '07:00',
            duration: 20,
            patient: 'Peter Wilson',
            practitioner: 'Lab Tech Maria',
            type: 'Laboratory',
            status: 'confirmed',
            location: 'Lab Room 1',
            clinic: 'SSO Clinic',
            notes: 'Fasting glucose test'
        },
        {
            id: 38,
            title: 'Prenatal Visit - Amanda Garcia',
            date: '2025-01-16',
            time: '09:00',
            duration: 45,
            patient: 'Amanda Garcia',
            practitioner: 'Dr. OBGYN Specialist',
            type: 'Prenatal Care',
            status: 'confirmed',
            location: 'OBGYN Suite',
            clinic: 'Muneeb Clinic',
            notes: '20-week anatomy scan'
        },
        {
            id: 39,
            title: 'Dermatology Check - Chris Brown',
            date: '2025-01-16',
            time: '11:30',
            duration: 30,
            patient: 'Chris Brown',
            practitioner: 'Dr. Skin Specialist',
            type: 'Dermatology',
            status: 'pending',
            location: 'Dermatology Room',
            clinic: 'McDowall Health',
            notes: 'Mole examination'
        },
        {
            id: 40,
            title: 'Eye Exam - Julia Martinez',
            date: '2025-01-16',
            time: '14:00',
            duration: 60,
            patient: 'Julia Martinez',
            practitioner: 'Dr. Eye Specialist',
            type: 'Ophthalmology',
            status: 'confirmed',
            location: 'Eye Clinic',
            clinic: 'Mahroz Clinic',
            notes: 'Annual vision screening'
        },
        {
            id: 41,
            title: 'Physical Therapy - George Taylor',
            date: '2025-01-16',
            time: '15:30',
            duration: 60,
            patient: 'George Taylor',
            practitioner: 'Dr. PT Specialist',
            type: 'Physical Therapy',
            status: 'confirmed',
            location: 'Therapy Room D',
            clinic: 'Imran Medical Center',
            notes: 'Back injury recovery'
        },
        
        // January 17, 2025 - Busy day (7 appointments)
        {
            id: 42,
            title: 'Emergency - Car Accident Victim',
            date: '2025-01-17',
            time: '06:30',
            duration: 90,
            patient: 'Emergency Patient',
            practitioner: 'Dr. Emergency Team',
            type: 'Emergency',
            status: 'urgent',
            location: 'Trauma Room',
            clinic: 'SSO Clinic',
            notes: 'Multi-trauma evaluation'
        },
        {
            id: 43,
            title: 'Routine Surgery - Helen Davis',
            date: '2025-01-17',
            time: '08:00',
            duration: 120,
            patient: 'Helen Davis',
            practitioner: 'Dr. Surgeon One',
            type: 'Surgery',
            status: 'confirmed',
            location: 'Operating Room 1',
            clinic: 'McDowall Health',
            notes: 'Gallbladder removal'
        },
        {
            id: 44,
            title: 'Pediatric Emergency - Baby Thompson',
            date: '2025-01-17',
            time: '12:00',
            duration: 45,
            patient: 'Baby Thompson',
            practitioner: 'Dr. Pediatric Emergency',
            type: 'Emergency',
            status: 'urgent',
            location: 'Pediatric Emergency',
            clinic: 'Mahroz Clinic',
            notes: 'High fever evaluation'
        },
        {
            id: 45,
            title: 'Cardiac Stress Test - William Johnson',
            date: '2025-01-17',
            time: '13:30',
            duration: 90,
            patient: 'William Johnson',
            practitioner: 'Dr. Cardiac Team',
            type: 'Cardiology',
            status: 'confirmed',
            location: 'Cardiac Lab',
            clinic: 'Imran Medical Center',
            notes: 'Exercise stress test'
        },
        {
            id: 46,
            title: 'Cancer Screening - Patricia White',
            date: '2025-01-17',
            time: '15:00',
            duration: 60,
            patient: 'Patricia White',
            practitioner: 'Dr. Oncology Team',
            type: 'Oncology',
            status: 'confirmed',
            location: 'Oncology Suite',
            clinic: 'Muneeb Clinic',
            notes: 'Annual cancer screening'
        },
        {
            id: 47,
            title: 'Mental Health Crisis - John Anderson',
            date: '2025-01-17',
            time: '17:30',
            duration: 60,
            patient: 'John Anderson',
            practitioner: 'Dr. Crisis Counselor',
            type: 'Mental Health',
            status: 'urgent',
            location: 'Crisis Room',
            clinic: 'SSO Clinic',
            notes: 'Emergency mental health intervention'
        },

        // January 18, 2025 - Very busy day (8 appointments)
        {
            id: 48,
            title: 'Early Morning Surgery - Michael Chen',
            date: '2025-01-18',
            time: '06:00',
            duration: 180,
            patient: 'Michael Chen',
            practitioner: 'Dr. Neurosurgeon',
            type: 'Surgery',
            status: 'confirmed',
            location: 'Operating Room 2',
            clinic: 'McDowall Health',
            notes: 'Brain tumor removal'
        },
        {
            id: 49,
            title: 'Chemotherapy - Linda Rodriguez',
            date: '2025-01-18',
            time: '08:00',
            duration: 240,
            patient: 'Linda Rodriguez',
            practitioner: 'Dr. Oncology Nurse',
            type: 'Oncology',
            status: 'confirmed',
            location: 'Chemo Suite',
            clinic: 'Muneeb Clinic',
            notes: 'Cycle 3 chemotherapy treatment'
        },
        {
            id: 50,
            title: 'Dialysis - Robert Garcia',
            date: '2025-01-18',
            time: '09:00',
            duration: 180,
            patient: 'Robert Garcia',
            practitioner: 'Dialysis Technician',
            type: 'Dialysis',
            status: 'confirmed',
            location: 'Dialysis Center',
            clinic: 'Imran Medical Center',
            notes: 'Routine dialysis session'
        },
        {
            id: 51,
            title: 'Multiple Trauma - Emergency Team',
            date: '2025-01-18',
            time: '12:30',
            duration: 120,
            patient: 'Trauma Patient 1',
            practitioner: 'Dr. Trauma Team',
            type: 'Emergency',
            status: 'urgent',
            location: 'Trauma Bay',
            clinic: 'SSO Clinic',
            notes: 'Multi-vehicle accident victim'
        },
        {
            id: 52,
            title: 'Psychiatric Evaluation - Sarah Kim',
            date: '2025-01-18',
            time: '14:00',
            duration: 90,
            patient: 'Sarah Kim',
            practitioner: 'Dr. Psychiatrist',
            type: 'Mental Health',
            status: 'pending',
            location: 'Psychiatric Unit',
            clinic: 'Mahroz Clinic',
            notes: 'Comprehensive mental health assessment'
        },
        {
            id: 53,
            title: 'Burn Treatment - David Wilson',
            date: '2025-01-18',
            time: '15:30',
            duration: 60,
            patient: 'David Wilson',
            practitioner: 'Dr. Burn Specialist',
            type: 'Emergency',
            status: 'urgent',
            location: 'Burn Unit',
            clinic: 'McDowall Health',
            notes: 'Second-degree burn care'
        },
        {
            id: 54,
            title: 'Intensive Care Round - ICU Team',
            date: '2025-01-18',
            time: '16:00',
            duration: 30,
            patient: 'ICU Patients',
            practitioner: 'Dr. ICU Team',
            type: 'Critical Care',
            status: 'confirmed',
            location: 'ICU',
            clinic: 'Imran Medical Center',
            notes: 'Evening ICU rounds'
        },

        // August 2025 - Heavy appointment days
        // August 5, 2025 - EXTREMELY BUSY DAY (20 appointments)
        {
            id: 55,
            title: 'Emergency Surgery - John Patterson',
            date: '2025-08-05',
            time: '06:00',
            duration: 240,
            patient: 'John Patterson',
            practitioner: 'Dr. Emergency Surgeon',
            type: 'Surgery',
            status: 'urgent',
            location: 'OR 1',
            clinic: 'SSO Clinic',
            notes: 'Emergency appendectomy'
        },
        {
            id: 56,
            title: 'Multiple Trauma - Highway Accident',
            date: '2025-08-05',
            time: '06:30',
            duration: 180,
            patient: 'Jane Trauma',
            practitioner: 'Dr. Trauma Team A',
            type: 'Emergency',
            status: 'urgent',
            location: 'Trauma Bay 1',
            clinic: 'McDowall Health',
            notes: 'Multi-vehicle accident victim'
        },
        {
            id: 57,
            title: 'Cardiac Emergency - Heart Attack',
            date: '2025-08-05',
            time: '07:00',
            duration: 120,
            patient: 'Robert Emergency',
            practitioner: 'Dr. Cardiac Emergency',
            type: 'Cardiology',
            status: 'urgent',
            location: 'Cardiac ICU',
            clinic: 'Mahroz Clinic',
            notes: 'STEMI heart attack treatment'
        },
        {
            id: 58,
            title: 'Burn Victim Treatment',
            date: '2025-08-05',
            time: '07:30',
            duration: 90,
            patient: 'Lisa Burns',
            practitioner: 'Dr. Burn Specialist',
            type: 'Emergency',
            status: 'urgent',
            location: 'Burn Unit',
            clinic: 'Imran Medical Center',
            notes: 'Third-degree burns treatment'
        },
        {
            id: 59,
            title: 'Pediatric Emergency - Choking',
            date: '2025-08-05',
            time: '08:00',
            duration: 60,
            patient: 'Baby Emma',
            practitioner: 'Dr. Pediatric Emergency',
            type: 'Emergency',
            status: 'urgent',
            location: 'Pediatric ER',
            clinic: 'Muneeb Clinic',
            notes: 'Foreign object removal'
        },
        {
            id: 60,
            title: 'Stroke Patient - Code Blue',
            date: '2025-08-05',
            time: '08:30',
            duration: 150,
            patient: 'Mary Stroke',
            practitioner: 'Dr. Neurology Team',
            type: 'Neurology',
            status: 'urgent',
            location: 'Neuro ICU',
            clinic: 'SSO Clinic',
            notes: 'Acute stroke intervention'
        },
        {
            id: 61,
            title: 'Mass Casualty - Bus Accident',
            date: '2025-08-05',
            time: '09:00',
            duration: 120,
            patient: 'Multiple Victims',
            practitioner: 'Dr. Emergency Teams',
            type: 'Emergency',
            status: 'urgent',
            location: 'Emergency Ward',
            clinic: 'McDowall Health',
            notes: 'Multiple casualties from bus crash'
        },
        {
            id: 62,
            title: 'Critical Surgery - Organ Transplant',
            date: '2025-08-05',
            time: '10:00',
            duration: 360,
            patient: 'David Transplant',
            practitioner: 'Dr. Transplant Team',
            type: 'Surgery',
            status: 'confirmed',
            location: 'OR 2',
            clinic: 'Mahroz Clinic',
            notes: 'Kidney transplant surgery'
        },
        {
            id: 63,
            title: 'Cancer Surgery - Tumor Removal',
            date: '2025-08-05',
            time: '11:00',
            duration: 300,
            patient: 'Patricia Cancer',
            practitioner: 'Dr. Oncology Surgeon',
            type: 'Surgery',
            status: 'confirmed',
            location: 'OR 3',
            clinic: 'Imran Medical Center',
            notes: 'Brain tumor resection'
        },
        {
            id: 64,
            title: 'Emergency C-Section',
            date: '2025-08-05',
            time: '12:00',
            duration: 90,
            patient: 'Sarah Delivery',
            practitioner: 'Dr. OBGYN Emergency',
            type: 'Surgery',
            status: 'urgent',
            location: 'Delivery Room',
            clinic: 'Muneeb Clinic',
            notes: 'Emergency cesarean delivery'
        },
        {
            id: 65,
            title: 'Spinal Surgery - Emergency',
            date: '2025-08-05',
            time: '13:00',
            duration: 240,
            patient: 'Michael Spine',
            practitioner: 'Dr. Neurosurgeon',
            type: 'Surgery',
            status: 'urgent',
            location: 'OR 4',
            clinic: 'SSO Clinic',
            notes: 'Emergency spinal fusion'
        },
        {
            id: 66,
            title: 'Trauma Surgery - Internal Bleeding',
            date: '2025-08-05',
            time: '14:00',
            duration: 180,
            patient: 'Jessica Trauma',
            practitioner: 'Dr. Trauma Surgeon',
            type: 'Surgery',
            status: 'urgent',
            location: 'OR 5',
            clinic: 'McDowall Health',
            notes: 'Emergency laparotomy'
        },
        {
            id: 67,
            title: 'Chemotherapy - Emergency Session',
            date: '2025-08-05',
            time: '15:00',
            duration: 180,
            patient: 'Richard Chemo',
            practitioner: 'Dr. Oncology Nurse',
            type: 'Oncology',
            status: 'urgent',
            location: 'Oncology Ward',
            clinic: 'Mahroz Clinic',
            notes: 'Emergency chemotherapy cycle'
        },
        {
            id: 68,
            title: 'Dialysis - Critical Patient',
            date: '2025-08-05',
            time: '16:00',
            duration: 240,
            patient: 'Nancy Dialysis',
            practitioner: 'Dr. Nephrology',
            type: 'Dialysis',
            status: 'urgent',
            location: 'Dialysis Unit',
            clinic: 'Imran Medical Center',
            notes: 'Emergency dialysis session'
        },
        {
            id: 69,
            title: 'ICU Rounds - Critical Patients',
            date: '2025-08-05',
            time: '17:00',
            duration: 60,
            patient: 'ICU Patients',
            practitioner: 'Dr. ICU Team',
            type: 'Critical Care',
            status: 'confirmed',
            location: 'ICU',
            clinic: 'Muneeb Clinic',
            notes: 'Evening critical care rounds'
        },
        {
            id: 70,
            title: 'Emergency Blood Transfusion',
            date: '2025-08-05',
            time: '18:00',
            duration: 90,
            patient: 'Chris Transfusion',
            practitioner: 'Dr. Hematology',
            type: 'Emergency',
            status: 'urgent',
            location: 'Blood Bank',
            clinic: 'SSO Clinic',
            notes: 'Emergency blood transfusion'
        },
        {
            id: 71,
            title: 'Psychiatric Emergency - Crisis',
            date: '2025-08-05',
            time: '19:00',
            duration: 120,
            patient: 'Amanda Crisis',
            practitioner: 'Dr. Psychiatrist',
            type: 'Mental Health',
            status: 'urgent',
            location: 'Psychiatric Ward',
            clinic: 'McDowall Health',
            notes: 'Mental health crisis intervention'
        },
        {
            id: 72,
            title: 'Night Surgery - Emergency',
            date: '2025-08-05',
            time: '20:00',
            duration: 180,
            patient: 'Paul Night Surgery',
            practitioner: 'Dr. Night Surgeon',
            type: 'Surgery',
            status: 'urgent',
            location: 'OR 6',
            clinic: 'Mahroz Clinic',
            notes: 'Emergency gallbladder surgery'
        },
        {
            id: 73,
            title: 'Critical Care Transport',
            date: '2025-08-05',
            time: '21:00',
            duration: 60,
            patient: 'Transfer Patient',
            practitioner: 'Dr. Transport Team',
            type: 'Critical Care',
            status: 'confirmed',
            location: 'Ambulance Bay',
            clinic: 'Imran Medical Center',
            notes: 'Critical patient transfer'
        },
        {
            id: 74,
            title: 'Overnight Monitoring',
            date: '2025-08-05',
            time: '22:00',
            duration: 480,
            patient: 'Monitored Patients',
            practitioner: 'Dr. Night Staff',
            type: 'Critical Care',
            status: 'confirmed',
            location: 'ICU',
            clinic: 'Muneeb Clinic',
            notes: 'Overnight patient monitoring'
        },

        // August 10, 2025 - VERY BUSY DAY (15 appointments)
        {
            id: 75,
            title: 'Morning Surgery - Hip Replacement',
            date: '2025-08-10',
            time: '07:00',
            duration: 180,
            patient: 'Helen Hip',
            practitioner: 'Dr. Orthopedic Surgeon',
            type: 'Surgery',
            status: 'confirmed',
            location: 'OR 1',
            clinic: 'SSO Clinic',
            notes: 'Total hip replacement surgery'
        },
        {
            id: 76,
            title: 'Cardiac Catheterization',
            date: '2025-08-10',
            time: '08:00',
            duration: 120,
            patient: 'Robert Heart',
            practitioner: 'Dr. Cardiologist',
            type: 'Cardiology',
            status: 'confirmed',
            location: 'Cath Lab',
            clinic: 'McDowall Health',
            notes: 'Diagnostic cardiac catheterization'
        },
        {
            id: 77,
            title: 'Knee Surgery - ACL Repair',
            date: '2025-08-10',
            time: '09:00',
            duration: 150,
            patient: 'Jennifer Knee',
            practitioner: 'Dr. Sports Medicine',
            type: 'Surgery',
            status: 'confirmed',
            location: 'OR 2',
            clinic: 'Mahroz Clinic',
            notes: 'ACL reconstruction surgery'
        },
        {
            id: 78,
            title: 'Colonoscopy Screening',
            date: '2025-08-10',
            time: '10:00',
            duration: 60,
            patient: 'Mark Screening',
            practitioner: 'Dr. Gastroenterologist',
            type: 'Diagnostic',
            status: 'confirmed',
            location: 'Endoscopy Suite',
            clinic: 'Imran Medical Center',
            notes: 'Routine colorectal screening'
        },
        {
            id: 79,
            title: 'Cataract Surgery',
            date: '2025-08-10',
            time: '11:00',
            duration: 90,
            patient: 'Mary Eyes',
            practitioner: 'Dr. Ophthalmologist',
            type: 'Surgery',
            status: 'confirmed',
            location: 'Eye Surgery Center',
            clinic: 'Muneeb Clinic',
            notes: 'Bilateral cataract removal'
        },
        {
            id: 80,
            title: 'Physical Therapy - Group Session',
            date: '2025-08-10',
            time: '12:00',
            duration: 90,
            patient: 'Group Therapy',
            practitioner: 'Dr. Physical Therapist',
            type: 'Physical Therapy',
            status: 'confirmed',
            location: 'Therapy Gym',
            clinic: 'SSO Clinic',
            notes: 'Group rehabilitation session'
        },
        {
            id: 81,
            title: 'Dental Surgery - Wisdom Teeth',
            date: '2025-08-10',
            time: '13:00',
            duration: 120,
            patient: 'Sarah Dental',
            practitioner: 'Dr. Oral Surgeon',
            type: 'Surgery',
            status: 'confirmed',
            location: 'Oral Surgery',
            clinic: 'McDowall Health',
            notes: 'Wisdom teeth extraction'
        },
        {
            id: 82,
            title: 'Dermatology - Skin Cancer Surgery',
            date: '2025-08-10',
            time: '14:00',
            duration: 75,
            patient: 'David Skin',
            practitioner: 'Dr. Dermatologist',
            type: 'Surgery',
            status: 'confirmed',
            location: 'Dermatology OR',
            clinic: 'Mahroz Clinic',
            notes: 'Mohs skin cancer surgery'
        },
        {
            id: 83,
            title: 'Endoscopy - Upper GI',
            date: '2025-08-10',
            time: '15:00',
            duration: 45,
            patient: 'Lisa Endoscopy',
            practitioner: 'Dr. GI Specialist',
            type: 'Diagnostic',
            status: 'confirmed',
            location: 'Endoscopy Suite',
            clinic: 'Imran Medical Center',
            notes: 'Upper GI endoscopy'
        },
        {
            id: 84,
            title: 'Plastic Surgery - Reconstructive',
            date: '2025-08-10',
            time: '16:00',
            duration: 240,
            patient: 'Amanda Reconstruction',
            practitioner: 'Dr. Plastic Surgeon',
            type: 'Surgery',
            status: 'confirmed',
            location: 'Plastic Surgery OR',
            clinic: 'Muneeb Clinic',
            notes: 'Post-mastectomy reconstruction'
        },
        {
            id: 85,
            title: 'Urology - Kidney Stone Removal',
            date: '2025-08-10',
            time: '17:00',
            duration: 90,
            patient: 'Michael Urology',
            practitioner: 'Dr. Urologist',
            type: 'Surgery',
            status: 'confirmed',
            location: 'Urology OR',
            clinic: 'SSO Clinic',
            notes: 'Laser kidney stone removal'
        },
        {
            id: 86,
            title: 'Chemotherapy - Cancer Treatment',
            date: '2025-08-10',
            time: '18:00',
            duration: 180,
            patient: 'Patricia Chemo',
            practitioner: 'Dr. Oncologist',
            type: 'Oncology',
            status: 'confirmed',
            location: 'Chemo Suite',
            clinic: 'McDowall Health',
            notes: 'Chemotherapy cycle 4'
        },
        {
            id: 87,
            title: 'Pain Management - Injection',
            date: '2025-08-10',
            time: '19:00',
            duration: 30,
            patient: 'Chris Pain',
            practitioner: 'Dr. Pain Specialist',
            type: 'Pain Management',
            status: 'confirmed',
            location: 'Pain Clinic',
            clinic: 'Mahroz Clinic',
            notes: 'Epidural steroid injection'
        },
        {
            id: 88,
            title: 'Sleep Study - Overnight',
            date: '2025-08-10',
            time: '20:00',
            duration: 480,
            patient: 'Nancy Sleep',
            practitioner: 'Dr. Sleep Specialist',
            type: 'Sleep Study',
            status: 'confirmed',
            location: 'Sleep Center',
            clinic: 'Imran Medical Center',
            notes: 'Overnight sleep apnea study'
        },
        {
            id: 89,
            title: 'Emergency Trauma - Late Night',
            date: '2025-08-10',
            time: '23:00',
            duration: 120,
            patient: 'Emergency Patient',
            practitioner: 'Dr. Night Emergency',
            type: 'Emergency',
            status: 'urgent',
            location: 'Emergency Room',
            clinic: 'Muneeb Clinic',
            notes: 'Late night trauma case'
        },

        // August 15, 2025 - MODERATE DAY (10 appointments)
        {
            id: 90,
            title: 'Morning Checkups - Multiple Patients',
            date: '2025-08-15',
            time: '08:00',
            duration: 30,
            patient: 'John Checkup',
            practitioner: 'Dr. Family Medicine',
            type: 'General Consultation',
            status: 'confirmed',
            location: 'Family Medicine',
            clinic: 'SSO Clinic',
            notes: 'Annual physical exam'
        },
        {
            id: 91,
            title: 'Vaccination Clinic - Children',
            date: '2025-08-15',
            time: '09:00',
            duration: 15,
            patient: 'Emma Vaccine',
            practitioner: 'Dr. Pediatrician',
            type: 'Vaccination',
            status: 'confirmed',
            location: 'Pediatric Clinic',
            clinic: 'McDowall Health',
            notes: 'Back-to-school vaccinations'
        },
        {
            id: 92,
            title: 'Prenatal Visit - Routine',
            date: '2025-08-15',
            time: '10:00',
            duration: 45,
            patient: 'Sarah Prenatal',
            practitioner: 'Dr. OBGYN',
            type: 'Prenatal Care',
            status: 'confirmed',
            location: 'OBGYN Clinic',
            clinic: 'Mahroz Clinic',
            notes: '28-week prenatal checkup'
        },
        {
            id: 93,
            title: 'Diabetes Management',
            date: '2025-08-15',
            time: '11:00',
            duration: 30,
            patient: 'Robert Diabetes',
            practitioner: 'Dr. Endocrinologist',
            type: 'Diabetes Management',
            status: 'confirmed',
            location: 'Endocrine Clinic',
            clinic: 'Imran Medical Center',
            notes: 'Quarterly diabetes check'
        },
        {
            id: 94,
            title: 'Mental Health Session',
            date: '2025-08-15',
            time: '12:00',
            duration: 50,
            patient: 'Jennifer Mental Health',
            practitioner: 'Dr. Psychologist',
            type: 'Mental Health',
            status: 'confirmed',
            location: 'Psychology Office',
            clinic: 'Muneeb Clinic',
            notes: 'Therapy session for anxiety'
        },
        {
            id: 95,
            title: 'Physical Therapy Session',
            date: '2025-08-15',
            time: '13:00',
            duration: 60,
            patient: 'Mark PT',
            practitioner: 'Dr. Physical Therapist',
            type: 'Physical Therapy',
            status: 'confirmed',
            location: 'Physical Therapy',
            clinic: 'SSO Clinic',
            notes: 'Post-surgery rehabilitation'
        },
        {
            id: 96,
            title: 'Eye Exam - Routine',
            date: '2025-08-15',
            time: '14:00',
            duration: 30,
            patient: 'Mary Vision',
            practitioner: 'Dr. Optometrist',
            type: 'Eye Exam',
            status: 'confirmed',
            location: 'Vision Center',
            clinic: 'McDowall Health',
            notes: 'Annual vision screening'
        },
        {
            id: 97,
            title: 'Dental Cleaning',
            date: '2025-08-15',
            time: '15:00',
            duration: 45,
            patient: 'David Dental',
            practitioner: 'Dr. Dental Hygienist',
            type: 'Dental Care',
            status: 'confirmed',
            location: 'Dental Office',
            clinic: 'Mahroz Clinic',
            notes: 'Six-month dental cleaning'
        },
        {
            id: 98,
            title: 'Dermatology Check',
            date: '2025-08-15',
            time: '16:00',
            duration: 30,
            patient: 'Lisa Skin Check',
            practitioner: 'Dr. Dermatologist',
            type: 'Dermatology',
            status: 'confirmed',
            location: 'Dermatology',
            clinic: 'Imran Medical Center',
            notes: 'Skin cancer screening'
        },
        {
            id: 99,
            title: 'Follow-up Visit',
            date: '2025-08-15',
            time: '17:00',
            duration: 20,
            patient: 'Amanda Follow-up',
            practitioner: 'Dr. Internal Medicine',
            type: 'Follow-up',
            status: 'confirmed',
            location: 'Internal Medicine',
            clinic: 'Muneeb Clinic',
            notes: 'Post-treatment follow-up'
        },

        // August 20, 2025 - LIGHT DAY (3 appointments)
        {
            id: 100,
            title: 'Morning Surgery - Outpatient',
            date: '2025-08-20',
            time: '09:00',
            duration: 90,
            patient: 'John Outpatient',
            practitioner: 'Dr. Surgeon',
            type: 'Surgery',
            status: 'confirmed',
            location: 'Outpatient Surgery',
            clinic: 'SSO Clinic',
            notes: 'Minor outpatient procedure'
        },
        {
            id: 101,
            title: 'Afternoon Consultation',
            date: '2025-08-20',
            time: '14:00',
            duration: 45,
            patient: 'Sarah Consultation',
            practitioner: 'Dr. Specialist',
            type: 'Consultation',
            status: 'confirmed',
            location: 'Consultation Room',
            clinic: 'McDowall Health',
            notes: 'Specialist consultation'
        },
        {
            id: 102,
            title: 'Evening Check-up',
            date: '2025-08-20',
            time: '17:00',
            duration: 30,
            patient: 'Robert Evening',
            practitioner: 'Dr. Family Medicine',
            type: 'General Consultation',
            status: 'confirmed',
            location: 'Family Medicine',
            clinic: 'Mahroz Clinic',
            notes: 'Routine evening checkup'
        },

        // August 25, 2025 - BUSY DAY (12 appointments)
        {
            id: 103,
            title: 'Early Surgery - Complex Case',
            date: '2025-08-25',
            time: '06:30',
            duration: 300,
            patient: 'Complex Patient',
            practitioner: 'Dr. Chief Surgeon',
            type: 'Surgery',
            status: 'confirmed',
            location: 'OR Complex',
            clinic: 'Imran Medical Center',
            notes: 'Complex multi-organ surgery'
        },
        {
            id: 104,
            title: 'Emergency Response Team',
            date: '2025-08-25',
            time: '08:00',
            duration: 60,
            patient: 'Emergency Calls',
            practitioner: 'Dr. Emergency Team',
            type: 'Emergency',
            status: 'urgent',
            location: 'Emergency Dept',
            clinic: 'Muneeb Clinic',
            notes: 'Emergency response calls'
        },
        {
            id: 105,
            title: 'Cancer Treatment - Radiation',
            date: '2025-08-25',
            time: '09:00',
            duration: 45,
            patient: 'Cancer Patient A',
            practitioner: 'Dr. Radiation Oncologist',
            type: 'Oncology',
            status: 'confirmed',
            location: 'Radiation Therapy',
            clinic: 'SSO Clinic',
            notes: 'Daily radiation treatment'
        },
        {
            id: 106,
            title: 'Rehabilitation Session',
            date: '2025-08-25',
            time: '10:00',
            duration: 90,
            patient: 'Rehab Patient',
            practitioner: 'Dr. Rehabilitation',
            type: 'Physical Therapy',
            status: 'confirmed',
            location: 'Rehab Center',
            clinic: 'McDowall Health',
            notes: 'Post-stroke rehabilitation'
        },
        {
            id: 107,
            title: 'Pediatric Surgery - Minor',
            date: '2025-08-25',
            time: '11:00',
            duration: 60,
            patient: 'Child Patient',
            practitioner: 'Dr. Pediatric Surgeon',
            type: 'Surgery',
            status: 'confirmed',
            location: 'Pediatric OR',
            clinic: 'Mahroz Clinic',
            notes: 'Minor pediatric procedure'
        },
        {
            id: 108,
            title: 'Cardiac Testing - Stress Test',
            date: '2025-08-25',
            time: '12:00',
            duration: 120,
            patient: 'Heart Patient',
            practitioner: 'Dr. Cardiac Tech',
            type: 'Cardiology',
            status: 'confirmed',
            location: 'Cardiac Lab',
            clinic: 'Imran Medical Center',
            notes: 'Nuclear stress test'
        },
        {
            id: 109,
            title: 'Mental Health Crisis',
            date: '2025-08-25',
            time: '13:30',
            duration: 90,
            patient: 'Crisis Patient',
            practitioner: 'Dr. Crisis Counselor',
            type: 'Mental Health',
            status: 'urgent',
            location: 'Crisis Center',
            clinic: 'Muneeb Clinic',
            notes: 'Mental health emergency'
        },
        {
            id: 110,
            title: 'Wound Care - Complex',
            date: '2025-08-25',
            time: '15:00',
            duration: 45,
            patient: 'Wound Patient',
            practitioner: 'Dr. Wound Specialist',
            type: 'Wound Care',
            status: 'confirmed',
            location: 'Wound Care Center',
            clinic: 'SSO Clinic',
            notes: 'Complex wound dressing'
        },
        {
            id: 111,
            title: 'Dialysis - Scheduled',
            date: '2025-08-25',
            time: '16:00',
            duration: 240,
            patient: 'Dialysis Patient',
            practitioner: 'Dr. Nephrology',
            type: 'Dialysis',
            status: 'confirmed',
            location: 'Dialysis Center',
            clinic: 'McDowall Health',
            notes: 'Scheduled dialysis session'
        },
        {
            id: 112,
            title: 'Pain Management - Procedures',
            date: '2025-08-25',
            time: '17:30',
            duration: 60,
            patient: 'Pain Patient',
            practitioner: 'Dr. Pain Management',
            type: 'Pain Management',
            status: 'confirmed',
            location: 'Pain Clinic',
            clinic: 'Mahroz Clinic',
            notes: 'Pain injection procedure'
        },
        {
            id: 113,
            title: 'Evening Surgery - Emergency',
            date: '2025-08-25',
            time: '19:00',
            duration: 150,
            patient: 'Evening Emergency',
            practitioner: 'Dr. Night Surgeon',
            type: 'Surgery',
            status: 'urgent',
            location: 'OR Night',
            clinic: 'Imran Medical Center',
            notes: 'Emergency evening surgery'
        },
        {
            id: 114,
            title: 'Critical Care Round',
            date: '2025-08-25',
            time: '21:00',
            duration: 45,
            patient: 'ICU Patients',
            practitioner: 'Dr. ICU Team',
            type: 'Critical Care',
            status: 'confirmed',
            location: 'ICU',
            clinic: 'Muneeb Clinic',
            notes: 'Evening ICU rounds'
        }
    ];

    // Clinic color mapping for visual identification
    const clinicColors = {
        'SSO Clinic': { bg: 'bg-blue-50', border: 'border-l-blue-500', text: 'text-blue-700', dot: 'bg-blue-500' },
        'McDowall Health': { bg: 'bg-green-50', border: 'border-l-green-500', text: 'text-green-700', dot: 'bg-green-500' },
        'Mahroz Clinic': { bg: 'bg-purple-50', border: 'border-l-purple-500', text: 'text-purple-700', dot: 'bg-purple-500' },
        'Imran Medical Center': { bg: 'bg-orange-50', border: 'border-l-orange-500', text: 'text-orange-700', dot: 'bg-orange-500' },
        'Muneeb Clinic': { bg: 'bg-pink-50', border: 'border-l-pink-500', text: 'text-pink-700', dot: 'bg-pink-500' },
    };

    // Get unique clinics for filter dropdown  
    const clinics = [...new Set(sourceFilteredAppointments.map(apt => apt.clinic).filter(Boolean))].sort();
    
    // PERFORMANCE: Memoized filtering to prevent unnecessary re-calculations
    const filteredAppointments = useMemo(() => {
        return sourceFilteredAppointments.filter(appointment => {
            const clinicMatch = appliedClinic === 'all' || appointment.clinic === appliedClinic;
            const statusMatch = appliedStatus === 'all' || appointment.status === appliedStatus;
            return clinicMatch && statusMatch;
        });
    }, [sourceFilteredAppointments, appliedClinic, appliedStatus]);

    // PERFORMANCE: Pre-group appointments by date for O(1) lookups
    const appointmentsByDate = useMemo(() => {
        const grouped: Record<string, Appointment[]> = {};
        filteredAppointments.forEach(appointment => {
            if (!grouped[appointment.date]) {
                grouped[appointment.date] = [];
            }
            grouped[appointment.date].push(appointment);
        });
        return grouped;
    }, [filteredAppointments]);
    
    const days = getDaysInMonth(selectedDate);
    const monthNames = [
        'January', 'February', 'March', 'April', 'May', 'June',
        'July', 'August', 'September', 'October', 'November', 'December'
    ];
    
    const weekDays = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
    
    const currentMonth = selectedDate.getMonth();
    const currentYear = selectedDate.getFullYear();
    
    // PERFORMANCE: Memoized date lookup function
    const getAppointmentsForDate = useCallback((date: Date) => {
        const dateStr = date.toISOString().split('T')[0];
        return appointmentsByDate[dateStr] || [];
    }, [appointmentsByDate]);

    // PERFORMANCE: Memoized week calculation
    const getWeekDays = useCallback((date: Date) => {
        const week = [];
        const startOfWeek = new Date(date);
        const day = startOfWeek.getDay();
        startOfWeek.setDate(startOfWeek.getDate() - day);
        
        for (let i = 0; i < 7; i++) {
            const dayDate = new Date(startOfWeek);
            dayDate.setDate(startOfWeek.getDate() + i);
            week.push(dayDate);
        }
        return week;
    }, []);

    // PERFORMANCE: Memoized view data
    const viewData = useMemo(() => {
        switch (currentView) {
            case 'month':
                return { days: getDaysInMonth(selectedDate) };
            case 'week':
                return { days: getWeekDays(selectedDate) };
            case 'day':
                return { days: [selectedDate] };
            case 'list':
                return { appointments: filteredAppointments.slice(0, 50) }; // Limit for performance
            default:
                return { days: getDaysInMonth(selectedDate) };
        }
    }, [currentView, selectedDate, filteredAppointments, getWeekDays]);
    
    // Enhanced navigation for different views
    const navigate = useCallback((direction: 'prev' | 'next') => {
        setSelectedDate(prev => {
            const newDate = new Date(prev);
            switch (currentView) {
                case 'month':
                    if (direction === 'prev') {
                        newDate.setMonth(prev.getMonth() - 1);
                    } else {
                        newDate.setMonth(prev.getMonth() + 1);
                    }
                    break;
                case 'week':
                    if (direction === 'prev') {
                        newDate.setDate(prev.getDate() - 7);
                    } else {
                        newDate.setDate(prev.getDate() + 7);
                    }
                    break;
                case 'day':
                    if (direction === 'prev') {
                        newDate.setDate(prev.getDate() - 1);
                    } else {
                        newDate.setDate(prev.getDate() + 1);
                    }
                    break;
                case 'list':
                    // List view doesn't need date navigation
                    return prev;
                default:
                    return prev;
            }
            return newDate;
        });
    }, [currentView]);

    // Keyboard navigation
    const handleKeyDown = useCallback((event: KeyboardEvent) => {
        switch (event.key) {
            case 'ArrowLeft':
                event.preventDefault();
                navigate('prev');
                break;
            case 'ArrowRight':
                event.preventDefault();
                navigate('next');
                break;
            case 't':
            case 'T':
                if (!event.ctrlKey && !event.metaKey) {
                    event.preventDefault();
                    setSelectedDate(new Date());
                }
                break;
            case 'm':
            case 'M':
                if (!event.ctrlKey && !event.metaKey) {
                    event.preventDefault();
                    setCurrentView('month');
                }
                break;
            case 'w':
            case 'W':
                if (!event.ctrlKey && !event.metaKey) {
                    event.preventDefault();
                    setCurrentView('week');
                }
                break;
            case 'd':
            case 'D':
                if (!event.ctrlKey && !event.metaKey) {
                    event.preventDefault();
                    setCurrentView('day');
                }
                break;
            case 'l':
            case 'L':
                if (!event.ctrlKey && !event.metaKey) {
                    event.preventDefault();
                    setCurrentView('list');
                }
                break;
        }
    }, [navigate]);

    // Add keyboard event listener
    useState(() => {
        document.addEventListener('keydown', handleKeyDown);
        return () => document.removeEventListener('keydown', handleKeyDown);
    });

// PERFORMANCE: Memoized Calendar Day Component
const CalendarDay = memo(({ 
    date, 
    dayAppointments, 
    isCurrentMonthDay, 
    isTodayDay, 
    clinicColors,
    statusColors,
    formatTime,
    setSelectedDayAppointments,
    setDayViewOpen,
    viewType = 'month'
}: {
    date: Date;
    dayAppointments: Appointment[];
    isCurrentMonthDay: boolean;
    isTodayDay: boolean;
    clinicColors: any;
    statusColors: any;
    formatTime: (time: string) => string;
    setSelectedDayAppointments: (appointments: Appointment[]) => void;
    setDayViewOpen: (open: boolean) => void;
    viewType?: 'month' | 'week' | 'day';
}) => {
    const maxVisible = viewType === 'day' ? 10 : viewType === 'week' ? 6 : 4;
    const cellHeight = viewType === 'day' ? 'min-h-[300px]' : viewType === 'week' ? 'min-h-[200px]' : 'min-h-[140px]';

    return (
        <div
            className={`
                ${cellHeight} p-2 border-r border-b border-border relative transition-colors duration-150
                ${isCurrentMonthDay ? 'bg-background hover:bg-muted/30' : 'bg-muted/20'}
                ${isTodayDay ? 'bg-primary/5 border-primary/20' : ''}
                hover:bg-muted/40 cursor-pointer
            `}
            role="gridcell"
            aria-label={`${date.toDateString()}, ${dayAppointments.length} appointments`}
            tabIndex={0}
        >
            <div className={`
                text-sm font-medium mb-2 flex items-center justify-center w-6 h-6 rounded-full
                ${isCurrentMonthDay ? 'text-foreground' : 'text-muted-foreground'}
                ${isTodayDay ? 'bg-primary text-primary-foreground font-semibold' : ''}
            `}>
                {date.getDate()}
            </div>
            <div className="space-y-1 relative">
                {dayAppointments.slice(0, maxVisible).map((appointment, appointmentIndex) => (
                    <Dialog key={appointment.id}>
                        <DialogTrigger asChild>
                            <div
                                className={`
                                    p-1.5 rounded text-xs cursor-pointer transition-all duration-150 mb-0.5 relative
                                    ${clinicColors[appointment.clinic as keyof typeof clinicColors]?.bg || 'bg-card'} 
                                    ${clinicColors[appointment.clinic as keyof typeof clinicColors]?.border || 'border-l-primary/70'} 
                                    border-l-2 hover:bg-muted/50 border border-border/50 hover:z-10 hover:scale-105
                                    ${dayAppointments.length > 1 ? 'shadow-lg' : 'shadow-sm'}
                                    ${appointmentIndex === 0 && dayAppointments.length > 1 ? 'transform -rotate-1' : ''}
                                    ${appointmentIndex === 1 && dayAppointments.length > 2 ? 'transform rotate-1 -mt-1' : ''}
                                    ${appointmentIndex === 2 && dayAppointments.length > 3 ? 'transform -rotate-0.5 -mt-1' : ''}
                                    ${appointmentIndex === 3 && dayAppointments.length > 4 ? 'transform rotate-0.5 -mt-1' : ''}
                                `}
                                style={{
                                    zIndex: dayAppointments.length - appointmentIndex,
                                }}
                                role="button"
                                aria-label={`${appointment.title} at ${formatTime(appointment.time)}`}
                            >
                                <div className="font-medium truncate text-xs leading-tight">
                                    {formatTime(appointment.time)}
                                </div>
                                <div className="text-muted-foreground truncate text-xs leading-tight">
                                    {appointment.patient}
                                </div>
                                <div className={`font-medium truncate text-xs leading-tight ${clinicColors[appointment.clinic as keyof typeof clinicColors]?.text || 'text-primary'}`}>
                                    {appointment.clinic}
                                </div>
                            </div>
                        </DialogTrigger>
                        <DialogContent className="max-w-md">
                            <DialogHeader>
                                <DialogTitle className="flex items-center gap-2">
                                    <span>{appointment.title}</span>
                                    <Badge className={statusColors[appointment.status]}>
                                        {appointment.status.charAt(0).toUpperCase() + appointment.status.slice(1)}
                                    </Badge>
                                </DialogTitle>
                            </DialogHeader>
                            <div className="space-y-4">
                                <div className="grid grid-cols-2 gap-4">
                                    <div className="flex items-center gap-3">
                                        <UserIcon className="h-4 w-4 text-gray-500" />
                                        <div>
                                            <Label className="text-sm text-gray-500">Patient</Label>
                                            <div className="font-medium">{appointment.patient}</div>
                                        </div>
                                    </div>
                                    
                                    <div className="flex items-center gap-3">
                                        <UserIcon className="h-4 w-4 text-blue-500" />
                                        <div>
                                            <Label className="text-sm text-gray-500">Practitioner</Label>
                                            <div className="font-medium">{appointment.practitioner}</div>
                                        </div>
                                    </div>
                                </div>

                                <div className="grid grid-cols-2 gap-4">
                                    <div className="flex items-center gap-3">
                                        <CalendarIcon className="h-4 w-4 text-purple-500" />
                                        <div>
                                            <Label className="text-sm text-gray-500">Date & Time</Label>
                                            <div className="font-medium">{formatTime(appointment.time)}</div>
                                            <div className="text-sm text-gray-500">{appointment.duration} minutes</div>
                                        </div>
                                    </div>
                                    
                                    <div className="flex items-center gap-3">
                                        <div className={`w-3 h-3 rounded-full ${clinicColors[appointment.clinic as keyof typeof clinicColors]?.dot || 'bg-primary'}`}></div>
                                        <div>
                                            <Label className="text-sm text-gray-500">Clinic</Label>
                                            <div className="font-medium">{appointment.clinic}</div>
                                        </div>
                                    </div>
                                </div>

                                <div className="grid grid-cols-2 gap-4">
                                    <div className="flex items-center gap-3">
                                        <MapPinIcon className="h-4 w-4 text-green-500" />
                                        <div>
                                            <Label className="text-sm text-gray-500">Location</Label>
                                            <div className="font-medium">{appointment.location}</div>
                                        </div>
                                    </div>
                                </div>

                                {appointment.notes && (
                                    <div className="mt-4 p-3 bg-gray-50 rounded-lg">
                                        <Label className="text-sm text-gray-500">Notes</Label>
                                        <div className="text-sm mt-1">{appointment.notes}</div>
                                    </div>
                                )}
                            </div>
                        </DialogContent>
                    </Dialog>
                ))}
                {dayAppointments.length > maxVisible && (
                    <div 
                        className="text-xs text-primary font-medium cursor-pointer hover:bg-muted rounded px-2 py-1 transition-colors border border-primary/20 bg-primary/5 hover:bg-primary/10"
                        onClick={() => {
                            setSelectedDayAppointments(dayAppointments);
                            setDayViewOpen(true);
                        }}
                        role="button"
                        aria-label={`View ${dayAppointments.length - maxVisible} more appointments`}
                    >
                        +{dayAppointments.length - maxVisible} more
                    </div>
                )}
            </div>
        </div>
    );
});
    
    const isToday = (date: Date) => {
        const today = new Date();
        return date.toDateString() === today.toDateString();
    };
    
    const isCurrentMonth = (date: Date) => {
        return date.getMonth() === currentMonth;
    };

    // PERFORMANCE: Memoized List View Component
    const ListViewComponent = memo(() => (
        <Card className="lg:col-span-3">
            <CardHeader className="border-b bg-background">
                <CardTitle className="text-lg font-semibold">All Appointments</CardTitle>
            </CardHeader>
            <CardContent className="p-0">
                <div className="max-h-[600px] overflow-y-auto">
                    {viewData.appointments && viewData.appointments.length > 0 ? (
                        <div className="divide-y">
                            {viewData.appointments.map((appointment) => (
                                <div
                                    key={appointment.id}
                                    className={`
                                        p-6 hover:bg-muted/30 transition-colors cursor-pointer
                                        ${clinicColors[appointment.clinic as keyof typeof clinicColors]?.bg || 'bg-card'} 
                                        border-l-4 ${clinicColors[appointment.clinic as keyof typeof clinicColors]?.border || 'border-l-primary/70'}
                                    `}
                                    role="listitem"
                                >
                                    <div className="flex items-start justify-between">
                                        <div className="flex-1">
                                            <div className="flex items-center gap-3 mb-2">
                                                <div className="font-semibold text-base">
                                                    {formatTime(appointment.time)} - {appointment.title}
                                                </div>
                                                <Badge className={statusColors[appointment.status]}>
                                                    {appointment.status.charAt(0).toUpperCase() + appointment.status.slice(1)}
                                                </Badge>
                                                <div className={`w-3 h-3 rounded-full ${clinicColors[appointment.clinic as keyof typeof clinicColors]?.dot || 'bg-primary'}`}></div>
                                            </div>
                                            <div className="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm text-muted-foreground">
                                                <div className="flex items-center gap-2">
                                                    <UserIcon className="h-4 w-4" />
                                                    <span>{appointment.patient}</span>
                                                </div>
                                                <div className="flex items-center gap-2">
                                                    <UserIcon className="h-4 w-4 text-blue-500" />
                                                    <span>{appointment.practitioner}</span>
                                                </div>
                                                <div className="flex items-center gap-2">
                                                    <MapPinIcon className="h-4 w-4" />
                                                    <span>{appointment.location}</span>
                                                </div>
                                                <div className="flex items-center gap-2">
                                                    <ClockIcon className="h-4 w-4" />
                                                    <span>{appointment.duration} min</span>
                                                </div>
                                            </div>
                                            <div className={`font-medium text-sm mt-2 ${clinicColors[appointment.clinic as keyof typeof clinicColors]?.text || 'text-primary'}`}>
                                                {appointment.clinic} ‚Ä¢ {new Date(appointment.date).toLocaleDateString()}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    ) : (
                        <div className="text-center text-muted-foreground py-12">
                            <CalendarIcon className="h-12 w-12 mx-auto mb-3 text-muted-foreground/50" />
                            <p>No appointments found</p>
                        </div>
                    )}
                </div>
            </CardContent>
        </Card>
    ));

    // PERFORMANCE: Memoized Calendar Grid Component  
    const CalendarGridComponent = memo(({ viewType }: { viewType: 'month' | 'week' | 'day' }) => {
        const days = viewData.days || [];
        const gridCols = viewType === 'day' ? 'grid-cols-1' : 'grid-cols-7';
        
        return (
            <Card className="lg:col-span-3">
                <CardHeader className="border-b bg-background">
                    <div className="flex items-center justify-between">
                        <CardTitle className="text-2xl font-semibold text-foreground">
                            {currentView === 'month' && `${monthNames[currentMonth]} ${currentYear}`}
                            {currentView === 'week' && `Week of ${selectedDate.toLocaleDateString()}`}
                            {currentView === 'day' && selectedDate.toLocaleDateString()}
                        </CardTitle>
                        <div className="flex items-center gap-1">
                            <Button
                                variant="ghost"
                                size="sm"
                                onClick={() => navigate('prev')}
                                className="hover:bg-muted"
                                aria-label="Previous"
                            >
                                <ChevronLeftIcon className="h-4 w-4" />
                            </Button>
                            <Button
                                variant="ghost"
                                size="sm"
                                onClick={() => setSelectedDate(new Date())}
                                className="hover:bg-muted"
                                aria-label="Today"
                            >
                                Today
                            </Button>
                            <Button
                                variant="ghost"
                                size="sm"
                                onClick={() => navigate('next')}
                                className="hover:bg-muted"
                                aria-label="Next"
                            >
                                <ChevronRightIcon className="h-4 w-4" />
                            </Button>
                        </div>
                    </div>
                </CardHeader>
                <CardContent className="p-0">
                    {/* Week day headers */}
                    {viewType !== 'day' && (
                        <div className={`grid ${gridCols} border-b bg-background`} role="row">
                            {weekDays.map(day => (
                                <div 
                                    key={day} 
                                    className="p-3 text-sm font-medium text-center border-r border-border"
                                    role="columnheader"
                                >
                                    {day}
                                </div>
                            ))}
                        </div>
                    )}
                    
                    {/* Calendar grid */}
                    <div className={`grid ${gridCols}`} role="grid" aria-label={`${currentView} view calendar`}>
                        {days.map((date, index) => {
                            const dayAppointments = getAppointmentsForDate(date);
                            const isCurrentMonthDay = isCurrentMonth(date);
                            const isTodayDay = isToday(date);
                            
                            return (
                                <CalendarDay
                                    key={index}
                                    date={date}
                                    dayAppointments={dayAppointments}
                                    isCurrentMonthDay={isCurrentMonthDay}
                                    isTodayDay={isTodayDay}
                                    clinicColors={clinicColors}
                                    statusColors={statusColors}
                                    formatTime={formatTime}
                                    setSelectedDayAppointments={setSelectedDayAppointments}
                                    setDayViewOpen={setDayViewOpen}
                                    viewType={viewType}
                                />
                            );
                        })}
                    </div>
                </CardContent>
            </Card>
        );
    });

    return (
        <AppLayout breadcrumbs={breadcrumbs}>
            <Head title="Calendar" />
            <div className="space-y-6 p-6">
                <div className="flex items-center justify-between">
                    <PageHeader title="Calendar" breadcrumbs={breadcrumbs} />
                    <div className="flex items-center gap-3">
                        {/* View Switching Buttons */}
                        <div className="flex items-center gap-1 mr-4 p-1 bg-muted rounded-lg" role="tablist" aria-label="Calendar views">
                            <Button
                                variant={currentView === 'month' ? 'default' : 'ghost'}
                                size="sm"
                                onClick={() => setCurrentView('month')}
                                className="h-8 px-3 text-xs"
                                role="tab"
                                aria-selected={currentView === 'month'}
                                aria-label="Month view"
                            >
                                Month
                            </Button>
                            <Button
                                variant={currentView === 'week' ? 'default' : 'ghost'}
                                size="sm"
                                onClick={() => setCurrentView('week')}
                                className="h-8 px-3 text-xs"
                                role="tab"
                                aria-selected={currentView === 'week'}
                                aria-label="Week view"
                            >
                                Week
                            </Button>
                            <Button
                                variant={currentView === 'day' ? 'default' : 'ghost'}
                                size="sm"
                                onClick={() => setCurrentView('day')}
                                className="h-8 px-3 text-xs"
                                role="tab"
                                aria-selected={currentView === 'day'}
                                aria-label="Day view"
                            >
                                Day
                            </Button>
                            <Button
                                variant={currentView === 'list' ? 'default' : 'ghost'}
                                size="sm"
                                onClick={() => setCurrentView('list')}
                                className="h-8 px-3 text-xs"
                                role="tab"
                                aria-selected={currentView === 'list'}
                                aria-label="List view"
                            >
                                List
                            </Button>
                        </div>
                        
                        <Button 
                            variant="ghost" 
                            size="sm"
                            onClick={() => {
                                setAppliedClinic('all');
                                setAppliedStatus('all');
                                setPendingClinic('all');
                                setPendingStatus('all');
                            }}
                            disabled={appliedClinic === 'all' && appliedStatus === 'all'}
                            className="h-9"
                        >
                            <RotateCcw className="mr-2 h-4 w-4" />
                            Reset
                        </Button>
                        <Sheet open={isFilterOpen} onOpenChange={(open) => {
                            if (open) {
                                // Initialize pending filters with current applied filters when opening
                                setPendingClinic(appliedClinic);
                                setPendingStatus(appliedStatus);
                            }
                            setIsFilterOpen(open);
                        }}>
                            <SheetTrigger asChild>
                                <Button variant="outline" className="flex items-center gap-2">
                                    <SlidersHorizontalIcon className="h-4 w-4" />
                                    Filters
                                    {(appliedClinic !== 'all' || appliedStatus !== 'all') && (
                                        <span className="ml-1 h-2 w-2 rounded-full bg-primary"></span>
                                    )}
                                </Button>
                            </SheetTrigger>
                            <SheetContent side="top" className="h-auto max-h-[80vh] p-8">
                                <div className="space-y-6">
                                    <div className="flex items-center justify-between">
                                        <div>
                                            <SheetTitle className="text-xl font-semibold">Filter Appointments</SheetTitle>
                                            <SheetDescription className="text-sm text-muted-foreground mt-1">
                                                Customize your calendar view by filtering appointments
                                            </SheetDescription>
                                        </div>
                                        <div className="flex items-center gap-2">
                                                                                            <span className="text-sm text-muted-foreground">
                                                    {filteredAppointments.length} appointments found
                                                </span>
                                                {(appliedClinic !== 'all' || appliedStatus !== 'all') && (
                                                    <Button 
                                                        variant="outline" 
                                                        size="sm" 
                                                        onClick={() => {
                                                            setAppliedClinic('all');
                                                            setAppliedStatus('all');
                                                            setPendingClinic('all');
                                                            setPendingStatus('all');
                                                        }}
                                                        className="h-8 px-3 text-xs"
                                                    >
                                                        Clear All
                                                    </Button>
                                                )}
                                        </div>
                                    </div>

                                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                                        <div className="space-y-3">
                                            <label className="text-sm font-medium block">Clinic</label>
                                            <Select value={pendingClinic} onValueChange={setPendingClinic}>
                                                <SelectTrigger className="h-11 px-3">
                                                    <div className="flex items-center gap-2">
                                                        <BuildingIcon className="h-4 w-4 text-muted-foreground" />
                                                        <SelectValue placeholder="Select clinic" />
                                                    </div>
                                                </SelectTrigger>
                                                <SelectContent>
                                                    <SelectItem value="all" className="py-2 px-3">
                                                        <div className="flex items-center gap-2">
                                                            <div className="w-3 h-3"></div>
                                                            <span>All Clinics</span>
                                                        </div>
                                                    </SelectItem>
                                                    {clinics.map((clinic) => (
                                                        <SelectItem key={clinic} value={clinic} className="py-2 px-3">
                                                            <div className="flex items-center gap-2">
                                                                <div className={`w-3 h-3 rounded-full ${clinicColors[clinic as keyof typeof clinicColors]?.dot || 'bg-primary'}`}></div>
                                                                <span>{clinic}</span>
                                                            </div>
                                                        </SelectItem>
                                                    ))}
                                                </SelectContent>
                                            </Select>
                                        </div>
                                        
                                        <div className="space-y-3">
                                            <label className="text-sm font-medium block">Status</label>
                                            <Select value={pendingStatus} onValueChange={setPendingStatus}>
                                                <SelectTrigger className="h-11 px-3">
                                                    <SelectValue placeholder="Select status" />
                                                </SelectTrigger>
                                                <SelectContent>
                                                    <SelectItem value="all" className="py-2 px-3">
                                                        <span>All Statuses</span>
                                                    </SelectItem>
                                                    <SelectItem value="confirmed" className="py-2 px-3">
                                                        <span>Confirmed</span>
                                                    </SelectItem>
                                                    <SelectItem value="pending" className="py-2 px-3">
                                                        <span>Pending</span>
                                                    </SelectItem>
                                                    <SelectItem value="urgent" className="py-2 px-3">
                                                        <span>Urgent</span>
                                                    </SelectItem>
                                                    <SelectItem value="cancelled" className="py-2 px-3">
                                                        <span>Cancelled</span>
                                                    </SelectItem>
                                                    <SelectItem value="completed" className="py-2 px-3">
                                                        <span>Completed</span>
                                                    </SelectItem>
                                                </SelectContent>
                                            </Select>
                                        </div>

                                        <div className="space-y-3">
                                            <label className="text-sm font-medium block">Quick Actions</label>
                                            <div className="flex gap-2">
                                                <Button 
                                                    variant="outline" 
                                                    size="sm"
                                                    onClick={() => setPendingStatus('pending')}
                                                    className="h-11 px-3 text-xs flex-1"
                                                >
                                                    Pending Only
                                                </Button>
                                                <Button 
                                                    variant="outline" 
                                                    size="sm"
                                                    onClick={() => setPendingStatus('urgent')}
                                                    className="h-11 px-3 text-xs flex-1"
                                                >
                                                    Urgent Only
                                                </Button>
                                            </div>
                                        </div>

                                        <div className="space-y-3">
                                            <label className="text-sm font-medium block">Actions</label>
                                            <div className="flex gap-2">
                                                <Button 
                                                    variant="outline" 
                                                    size="sm"
                                                    onClick={() => {
                                                        setPendingClinic('all');
                                                        setPendingStatus('all');
                                                    }}
                                                    className="h-11 px-3 text-xs flex-1"
                                                >
                                                    <RotateCcw className="mr-1 h-3 w-3" />
                                                    Reset All
                                                </Button>
                                                <Button 
                                                    variant="default" 
                                                    size="sm"
                                                    onClick={() => {
                                                        setAppliedClinic(pendingClinic);
                                                        setAppliedStatus(pendingStatus);
                                                        setIsFilterOpen(false);
                                                    }}
                                                    className="h-11 px-4 text-xs"
                                                >
                                                    Apply Filters
                                                </Button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </SheetContent>
                        </Sheet>
                        
                        <Button className="flex items-center gap-2">
                            <PlusIcon className="h-4 w-4" />
                            New Appointment
                        </Button>
                    </div>
                </div>

                <div className="grid grid-cols-1 lg:grid-cols-4 gap-6" role="main">
                    {/* Conditional View Rendering */}
                    {currentView === 'list' ? (
                        <ListViewComponent />
                    ) : (
                        <CalendarGridComponent viewType={currentView} />
                    )}
                    {/* Clean Today's Schedule Sidebar */}
                    <Card className="lg:col-span-1">
                        <CardHeader className="border-b bg-background">
                            <CardTitle className="text-lg font-semibold text-foreground">Today's Schedule</CardTitle>
                            <CardDescription className="text-muted-foreground">
                                {new Date().toLocaleDateString('en-US', {
                                    weekday: 'long',
                                    month: 'long',
                                    day: 'numeric'
                                })}
                            </CardDescription>
                        </CardHeader>
                        <CardContent>
                            <div className="space-y-3">
                                {getAppointmentsForDate(new Date()).length > 0 ? (
                                    getAppointmentsForDate(new Date()).map(appointment => (
                                        <Dialog key={appointment.id}>
                                            <DialogTrigger asChild>
                                                <div className={`
                                                    p-3 rounded cursor-pointer transition-colors hover:bg-muted/50
                                                    ${clinicColors[appointment.clinic as keyof typeof clinicColors]?.bg || 'bg-card'} 
                                                    ${clinicColors[appointment.clinic as keyof typeof clinicColors]?.border || 'border-l-primary'} 
                                                    border-l-2
                                                `}>
                                                    <div className="flex items-center justify-between mb-2">
                                                        <span className="text-sm font-medium">
                                                            {formatTime(appointment.time)}
                                                        </span>
                                                        <Badge className={statusColors[appointment.status]}>
                                                            {appointment.status}
                                                        </Badge>
                                                    </div>
                                                    <div className="text-sm font-medium mb-1">
                                                        {appointment.patient}
                                                    </div>
                                                    <div className="text-xs text-muted-foreground mb-1">
                                                        {appointment.practitioner}
                                                    </div>
                                                    <div className="flex items-center justify-between text-xs">
                                                        <span className="text-muted-foreground">
                                                            {appointment.type}
                                                        </span>
                                                        <span className={`font-medium ${clinicColors[appointment.clinic as keyof typeof clinicColors]?.text || 'text-primary'}`}>
                                                            {appointment.clinic}
                                                        </span>
                                                    </div>
                                                    <div className="text-xs text-muted-foreground mt-1">
                                                        üìç {appointment.location}
                                                    </div>
                                                </div>
                                            </DialogTrigger>
                                            <DialogContent className="max-w-md">
                                                <DialogHeader>
                                                    <DialogTitle className="flex items-center gap-2">
                                                        <span>{appointment.title}</span>
                                                        <Badge className={statusColors[appointment.status]}>
                                                            {appointment.status.charAt(0).toUpperCase() + appointment.status.slice(1)}
                                                        </Badge>
                                                    </DialogTitle>
                                                </DialogHeader>
                                                <div className="space-y-4">
                                                    <div className="grid grid-cols-2 gap-4">
                                                        <div className="flex items-center gap-3">
                                                            <UserIcon className="h-4 w-4 text-muted-foreground" />
                                                            <div>
                                                                <Label className="text-sm text-muted-foreground">Patient</Label>
                                                                <div className="font-medium">{appointment.patient}</div>
                                                            </div>
                                                        </div>
                                                        
                                                        <div className="flex items-center gap-3">
                                                            <UserIcon className="h-4 w-4 text-muted-foreground" />
                                                            <div>
                                                                <Label className="text-sm text-muted-foreground">Practitioner</Label>
                                                                <div className="font-medium">{appointment.practitioner}</div>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div className="flex items-center gap-3">
                                                        <div className={`w-4 h-4 rounded-full ${clinicColors[appointment.clinic as keyof typeof clinicColors]?.dot || 'bg-primary'}`}></div>
                                                        <div>
                                                            <Label className="text-sm text-muted-foreground">Clinic</Label>
                                                            <div className={`font-medium ${clinicColors[appointment.clinic as keyof typeof clinicColors]?.text || 'text-primary'}`}>
                                                                {appointment.clinic}
                                                            </div>
                                                        </div>
                                                    </div>
                                                    
                                                    <div className="flex items-center gap-3">
                                                        <CalendarIcon className="h-4 w-4 text-muted-foreground" />
                                                        <div>
                                                            <Label className="text-sm text-muted-foreground">Date & Time</Label>
                                                            <div className="font-medium">
                                                                {new Date(appointment.date).toLocaleDateString('en-US', {
                                                                    weekday: 'long',
                                                                    year: 'numeric',
                                                                    month: 'long',
                                                                    day: 'numeric'
                                                                })}
                                                            </div>
                                                            <div className="text-sm text-muted-foreground">
                                                                {formatTime(appointment.time)} ({appointment.duration} min)
                                                            </div>
                                                        </div>
                                                    </div>
                                                    
                                                    <div className="grid grid-cols-2 gap-4">
                                                        <div className="flex items-center gap-3">
                                                            <ClockIcon className="h-4 w-4 text-muted-foreground" />
                                                            <div>
                                                                <Label className="text-sm text-muted-foreground">Type</Label>
                                                                <div className="font-medium">{appointment.type}</div>
                                                            </div>
                                                        </div>
                                                        
                                                        <div className="flex items-center gap-3">
                                                            <MapPinIcon className="h-4 w-4 text-muted-foreground" />
                                                            <div>
                                                                <Label className="text-sm text-muted-foreground">Location</Label>
                                                                <div className="font-medium">{appointment.location}</div>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    {appointment.notes && (
                                                        <div className="mt-4 p-3 bg-muted rounded">
                                                            <Label className="text-sm text-muted-foreground">Notes</Label>
                                                            <div className="text-sm mt-1">{appointment.notes}</div>
                                                        </div>
                                                    )}
                                                </div>
                                            </DialogContent>
                                        </Dialog>
                                    ))
                                ) : (
                                    <div className="text-center text-muted-foreground py-8">
                                        <CalendarIcon className="h-12 w-12 mx-auto mb-3 text-muted-foreground/50" />
                                        <p className="text-sm">
                                            {appliedClinic !== 'all' || appliedStatus !== 'all' 
                                                ? 'No appointments match your filters today' 
                                                : 'No appointments today'
                                            }
                                        </p>
                                        {(appliedClinic !== 'all' || appliedStatus !== 'all') && (
                                            <Button 
                                                variant="outline" 
                                                size="sm" 
                                                onClick={() => {
                                                    setAppliedClinic('all');
                                                    setAppliedStatus('all');
                                                    setPendingClinic('all');
                                                    setPendingStatus('all');
                                                }}
                                                className="mt-2"
                                            >
                                                Clear Filters
                                            </Button>
                                        )}
                                    </div>
                                )}
                            </div>
                        </CardContent>
                    </Card>
                </div>
            </div>

            {/* Day View Dialog for showing all appointments */}
            <Dialog open={dayViewOpen} onOpenChange={setDayViewOpen}>
                <DialogContent className="max-w-3xl max-h-[80vh] overflow-y-auto">
                    <DialogHeader>
                        <DialogTitle className="flex items-center gap-2">
                            <CalendarIcon className="h-5 w-5" />
                            All Appointments
                            <Badge variant="secondary" className="ml-2">
                                {selectedDayAppointments.length} total
                            </Badge>
                        </DialogTitle>
                    </DialogHeader>
                    <div className="space-y-4 mt-6">
                        {selectedDayAppointments.length > 0 ? (
                            <div className="grid gap-3">
                                {selectedDayAppointments
                                    .sort((a, b) => a.time.localeCompare(b.time))
                                    .map((appointment) => (
                                    <div
                                        key={appointment.id}
                                        className={`
                                            p-4 rounded-lg border transition-colors duration-150
                                            ${clinicColors[appointment.clinic as keyof typeof clinicColors]?.bg || 'bg-card'} 
                                            ${clinicColors[appointment.clinic as keyof typeof clinicColors]?.border || 'border-l-primary/70'} 
                                            border-l-4 hover:bg-muted/30 shadow-sm
                                        `}
                                    >
                                        <div className="flex items-start justify-between">
                                            <div className="flex-1">
                                                <div className="flex items-center gap-3 mb-2">
                                                    <div className="font-semibold text-sm">
                                                        {formatTime(appointment.time)}
                                                    </div>
                                                    <Badge className={statusColors[appointment.status]}>
                                                        {appointment.status.charAt(0).toUpperCase() + appointment.status.slice(1)}
                                                    </Badge>
                                                    <div className={`w-3 h-3 rounded-full ${clinicColors[appointment.clinic as keyof typeof clinicColors]?.dot || 'bg-primary'}`}></div>
                                                </div>
                                                <div className="font-medium text-base mb-1">
                                                    {appointment.title}
                                                </div>
                                                <div className="grid grid-cols-2 gap-4 text-sm text-muted-foreground">
                                                    <div className="flex items-center gap-2">
                                                        <UserIcon className="h-4 w-4" />
                                                        <span>{appointment.patient}</span>
                                                    </div>
                                                    <div className="flex items-center gap-2">
                                                        <UserIcon className="h-4 w-4 text-blue-500" />
                                                        <span>{appointment.practitioner}</span>
                                                    </div>
                                                    <div className="flex items-center gap-2">
                                                        <MapPinIcon className="h-4 w-4" />
                                                        <span>{appointment.location}</span>
                                                    </div>
                                                    <div className="flex items-center gap-2">
                                                        <ClockIcon className="h-4 w-4" />
                                                        <span>{appointment.duration} min</span>
                                                    </div>
                                                </div>
                                                <div className={`font-medium text-sm mt-2 ${clinicColors[appointment.clinic as keyof typeof clinicColors]?.text || 'text-primary'}`}>
                                                    {appointment.clinic}
                                                </div>
                                                {appointment.notes && (
                                                    <div className="mt-3 p-3 bg-muted/50 rounded text-sm">
                                                        <strong>Notes:</strong> {appointment.notes}
                                                    </div>
                                                )}
                                            </div>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        ) : (
                            <div className="text-center text-muted-foreground py-8">
                                <CalendarIcon className="h-12 w-12 mx-auto mb-3 text-muted-foreground/50" />
                                <p>No appointments found for this day</p>
                            </div>
                        )}
                    </div>
                </DialogContent>
            </Dialog>
        </AppLayout>
    );
} 